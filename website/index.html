<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
    <title>Codenames Tournament</title>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
  </head>
  <body>
    <div class="app">
      <!-- App Header (desktop + mobile) -->
      <header class="app-header">
        <div class="logo">CODENAMES</div>

        <div class="header-user">
          <div class="header-user-stack">
            <div class="header-line">
              <span class="header-k">Name:</span>
              <span class="header-v" id="user-name-display" title="Double click to edit">—</span>
            </div>
            <div class="header-line">
              <span class="header-k">Team:</span>
              <span class="header-v team-accent" id="user-team-display">No team</span>
            </div>
          </div>
          <input class="input header-user-input" id="user-name-input" type="text" placeholder="Your name" style="display:none;" />
        </div>
      </header>

      <!-- Desktop Tabs -->
      <nav class="desktop-tabs" aria-label="Primary">
        <button class="tab active" data-panel="panel-home" type="button">Home</button>
        <button class="tab" data-panel="panel-teams" type="button">Teams</button>
        <button class="tab" data-panel="panel-players" type="button">Players</button>
        <button class="tab" data-panel="panel-myteam" type="button">My Team</button>
      </nav>

      <main class="main-content">
        <!-- Home -->
        <section class="panel panel-info active" id="panel-home">
          <div class="panel-inner">
            <div class="home-hero">
              <h1 class="home-title">Codenames Tournament</h1>
              <p class="subtitle">Set your name, then create a team or request to join one.</p>
            </div>

            <div class="spots-display">
              <div class="spots-number" id="spots-left">8</div>
              <div class="spots-label">spots left</div>
            </div>

            <div class="info-stats">
              <div class="info-stat">
                <span class="val" id="team-count">0</span>
                <span class="lbl">Teams</span>
              </div>
              <div class="info-stat">
                <span class="val">3</span>
                <span class="lbl">Per Team</span>
              </div>
              <div class="info-stat">
                <span class="val" id="players-count">0</span>
                <span class="lbl">Players</span>
              </div>
            </div>

            <!-- Sleek name dock (bottom on mobile, top-right on desktop header) -->
            <div class="name-dock" id="name-card">
              <form id="name-form" class="form name-dock-form">
                <label class="field" style="margin:0;">
                  <span class="label">Your name</span>
                  <input type="text" id="name-input" class="input" placeholder="Name" required>
                </label>
                <div class="form-actions" style="margin:0;">
                  <button type="submit" class="btn primary">Save</button>
                  <span class="hint" id="name-hint"></span>
                </div>
              </form>

              <div id="name-saved" class="name-dock-saved" style="display:none;">
                <div class="name-saved-stack">
                  <div class="name-dock-value" id="name-saved-display" title="Double click to edit">—</div>
                  <input class="input" id="name-saved-input" type="text" style="display:none;" />
                  <button class="btn logout" id="logout-btn" type="button">Log out</button>
                </div>
              </div>
            </div>
          </div>
        </section>

        <!-- Teams Page -->
        <section class="panel panel-teams" id="panel-teams">
          <div class="panel-inner">
            <h2>Teams <span class="pill" id="team-count-pill">0/8</span></h2>
            <p class="subtitle small">Members are shown below. Request to join any team with an open spot.</p>
            <span class="hint" id="teams-hint"></span>
            <div class="teams-list" id="teams-list"></div>
          </div>
        </section>

        <!-- Players Page -->
        <section class="panel panel-players" id="panel-players">
          <div class="panel-inner">
            <h2>Players</h2>
            <p class="subtitle small">Everyone who has entered their name. Team leaders can invite players who aren't on a team yet.</p>
            <span class="hint" id="players-hint"></span>
            <div class="players-directory" id="players-list"></div>
          </div>
        </section>

        <!-- My Team Page -->
        <section class="panel panel-register" id="panel-myteam">
          <div class="panel-inner">
            <h2>My Team</h2>
            <p class="subtitle small" id="myteam-subtitle">Create a team or manage your current team.</p>

            <div class="stack">
              <div class="team-card invites" id="invites-card" style="display:none;">
                <div class="team-body">
                  <div class="team-section-title">Invites</div>
                  <div id="invites-list"></div>
                  <div class="hint" id="invites-hint" style="margin-top:10px;"></div>
                </div>
              </div>

              <button class="btn primary" id="open-create-team" type="button">Create a team</button>

              <div class="team-card my-team" id="myteam-card" style="display:none;">
                <div class="team-summary no-details">
                  <div class="team-left">
                    <div class="team-rank">#</div>
                    <div class="team-name-wrap">
                      <span class="team-name editable team-accent" id="myteam-name" title="Double click to rename"></span>
                      <input class="team-name-input input" id="myteam-name-input" type="text" style="display:none;" />
                    </div>
                  </div>
                  <div class="team-right">
                    <span class="meta" id="myteam-size">0/3</span>
                  </div>
                </div>

                <div class="team-body">
                  <div class="team-section-title">Teammates</div>
                  <div class="players-list" id="myteam-members"></div>
                  <div class="owner-actions-row" id="myteam-actions"></div>

                  <div class="team-color-row" id="team-color-row" style="display:none;">
                    <div class="team-color-label">Team color</div>
                    <input class="team-color-input" id="team-color-input" type="color" value="#3b82f6" aria-label="Team color" />
                  </div>

                  <div class="myteam-footer">
<button class="btn small" id="open-requests" type="button" style="display:none;">Requests</button>
                    <button class="btn danger" id="leave-or-delete" type="button" style="display:none;">Leave team</button>
                  </div>
                </div>

                <!-- Floating chat button (icon) -->
                <button class="icon-btn floating-chat" id="open-chat" type="button" style="display:none;" aria-label="Team chat">
                  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M21 15a4 4 0 0 1-4 4H8l-5 3V7a4 4 0 0 1 4-4h10a4 4 0 0 1 4 4z"/>
                  </svg>
                </button>
              </div>
            </div>
          </div>
        </section>
      </main>

      <!-- Mobile Tabs -->
      <nav class="mobile-tabs">
        <button class="tab active" data-panel="panel-home" type="button">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/></svg>
          <span>Home</span>
        </button>
        <button class="tab" data-panel="panel-teams" type="button">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M23 21v-2a4 4 0 0 0-3-3.87M16 3.13a4 4 0 0 1 0 7.75"/></svg>
          <span>Teams</span>
        </button>
        <button class="tab" data-panel="panel-players" type="button">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M22 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></svg>
          <span>Players</span>
        </button>
        <button class="tab" data-panel="panel-myteam" type="button">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 5v14M5 12h14"/></svg>
          <span>My Team</span>
        </button>
      </nav>

      <!-- Team Modal -->
      <div class="modal" id="team-modal" style="display:none;" role="dialog" aria-modal="true">
        <div class="modal-card">
          <div class="modal-head">
            <div class="modal-title" id="team-modal-title">Team</div>
            <button class="icon-btn" id="team-modal-close" type="button" aria-label="Close">×</button>
          </div>
          <div class="modal-body">
            <div class="team-section-title">Members</div>
            <div class="players-list" id="team-modal-members"></div>
            <div class="form-actions" style="margin-top:12px;">
              <button class="btn primary" id="team-modal-join" type="button">Request to join</button>
              <span class="hint" id="team-modal-hint"></span>
            </div>
          </div>
        </div>
      </div>

      <!-- Requests Modal (Owner) -->
      <div class="modal" id="requests-modal" style="display:none;" role="dialog" aria-modal="true">
        <div class="modal-card">
          <div class="modal-head">
            <div class="modal-title">Team requests</div>
            <button class="icon-btn" id="requests-modal-close" type="button" aria-label="Close">×</button>
          </div>
          <div class="modal-body">
            <div class="team-section-title">Pending</div>
            <div id="requests-modal-list"></div>
            <div class="hint" id="requests-modal-hint" style="margin-top:10px;"></div>
          </div>
        </div>
      </div>

      <!-- Team Chat Modal -->
      <div class="modal" id="chat-modal" style="display:none;" role="dialog" aria-modal="true">
        <div class="modal-card">
          <div class="modal-head">
            <div class="modal-title" id="chat-modal-title">Team chat</div>
            <button class="icon-btn" id="chat-modal-close" type="button" aria-label="Close">×</button>
          </div>
          <div class="modal-body chat-modal-body">
            <div class="chat-messages" id="chat-messages"></div>
            <form class="chat-compose" id="chat-form">
              <input class="input chat-input" id="chat-input" type="text" placeholder="Message" autocomplete="off" />
              <button class="btn primary chat-send" id="chat-send" type="submit">Send</button>
            </form>
            <div class="hint" id="chat-hint" style="margin-top:10px;"></div>
          </div>
        </div>
      </div>

      <!-- Create Team Modal -->
      <div class="modal" id="create-team-modal" style="display:none;" role="dialog" aria-modal="true">
        <div class="modal-card">
          <div class="modal-head">
            <div class="modal-title">Create a team</div>
            <button class="icon-btn" id="create-team-close" type="button" aria-label="Close">×</button>
          </div>
          <div class="modal-body">
            <form id="create-team-form" class="form">
              <label class="field">
                <span class="label">Team name</span>
                <input type="text" id="create-teamName" class="input" placeholder="e.g., Night Owls" required>
              </label>
              <label class="field">
                <span class="label">Team color</span>
                <div class="color-picker-row">
                  <input type="color" id="create-teamColor" class="color-input" value="#3b82f6" aria-label="Team color" />
                  <span class="hint">Used for a subtle glow + highlights.</span>
                </div>
              </label>
              <div class="form-actions">
                <button type="submit" class="btn primary" id="create-team-submit">Create team</button>
                <span class="hint" id="create-team-hint"></span>
              </div>
            </form>
          </div>
        </div>
      </div>

      
    </div>

    <script src="app.js"></script>
  </body>
</html>
