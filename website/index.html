<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
    <title>Codenames Tournament</title>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
  </head>
  <body>
    <div class="app">
      <!-- Desktop Header -->
      <header class="desktop-header">
        <div class="logo">CODENAMES</div>
        <div class="header-center">Discord Tournament &bull; 3v3 &bull; 6 Teams Max</div>
        <div class="header-mode-switcher" id="header-mode-switcher-desktop">
          <span class="mode-label" id="mode-label-desktop">—</span>
          <button class="mode-btn" type="button" id="mode-set-creator-desktop">Creator</button>
          <button class="mode-btn" type="button" id="mode-set-joiner-desktop">Joining</button>
        </div>
        <div class="prize-badge">$150 Prize</div>
      </header>

      <!-- Desktop Tabs (shown on laptop/desktop) -->
      <nav class="desktop-tabs" aria-label="Primary">
        <button class="tab active" data-panel="panel-home" type="button" id="tab-home-desktop">Home</button>
        <button class="tab" data-panel="panel-register" type="button" id="tab-register-desktop">Teams</button>
        <button class="tab owner-only" data-panel="panel-requests" type="button" id="tab-requests-desktop" style="display:none;">Requests</button>        <button class="tab" data-panel="panel-teams" type="button" id="tab-teams-desktop">Roster</button>
      </nav>

      <!-- Main Content -->
      <main class="main-content">
        <!-- Panel 1: Info -->
        <section class="panel panel-info" id="panel-home">
          <div class="panel-inner">
            <div class="mobile-header">
              <span class="logo">CODENAMES</span>
              <div class="header-mode-switcher mobile" id="header-mode-switcher-mobile">
                <span class="mode-label" id="mode-label-mobile">—</span>
                <button class="mode-btn" type="button" id="mode-set-creator-mobile">Creator</button>
                <button class="mode-btn" type="button" id="mode-set-joiner-mobile">Join</button>
              </div>
              <span class="prize-badge">$150</span>
            </div>
            <h1>Discord Tournament</h1>
            <p class="subtitle">3v3 teams competing for $150</p>
            <div class="spots-display">
              <div class="spots-number" id="spots-left">6</div>
              <div class="spots-label">spots left</div>
            </div>
            <div class="info-stats">
              <div class="info-stat">
                <span class="val">6</span>
                <span class="lbl">Max Teams</span>
              </div>
              <div class="info-stat">
                <span class="val">3</span>
                <span class="lbl">Per Team</span>
              </div>
              <div class="info-stat">
                <span class="val" id="players-count">0</span>
                <span class="lbl">Players</span>
              </div>
            </div>
          </div>
        </section>

        <!-- Panel 2: Register -->
        
        <section class="panel panel-register" id="panel-register">
          <div class="panel-inner">
            <h2>Teams</h2>
            <p class="subtitle">Create a team or request to join one. Team owners can accept requests.</p>

            <div class="mode-dock mobile-only" id="mode-dock">
              <div class="mode-dock-left">Mode</div>
              <div class="mode-dock-actions">
                <button class="mode-btn" type="button" id="mode-set-creator-inline">Create</button>
                <button class="mode-btn" type="button" id="mode-set-joiner-inline">Join</button>
              </div>
            </div>



            <!-- Current user status (member / pending) -->
            <div id="my-status" class="status-card" style="display:none;"></div>

            <div class="stack">
              <details class="accordion" id="create-accordion" open>
                <summary>
                  <span>Create a team</span>
                  <span class="pill">new team</span>
                </summary>

                <form id="create-team-form" class="form">
                  <div class="form-grid">
                    <label class="field">
                      <span class="label">Team name</span>
                      <input type="text" id="create-teamName" class="input" placeholder="e.g., Night Owls" required>
                    </label>

                    <div class="two-col">
                      <label class="field">
                        <span class="label">Your name</span>
                        <input type="text" id="create-name" class="input" placeholder="Name" required>
                      </label>

                      <label class="field">
                        <span class="label">Your Discord</span>
                        <input type="text" id="create-discord" class="input" placeholder="@username" required>
                      </label>
                    </div>
                  </div>

                  <div class="form-actions">
                    <button type="submit" id="create-btn" class="btn primary">Create team</button>
                    <span class="hint" id="create-hint"></span>
                  </div>
                </form>
              </details>

              <details class="accordion" id="join-accordion">
                <summary>
                  <span>Request to join a team</span>
                  <span class="pill">friends</span>
                </summary>

                <div class="lockbar" id="join-lockbar" style="display:none;">
                  <div class="lockbar-left">You already requested to join a team.</div>
                  <button class="btn danger small" type="button" id="cancel-pending-btn">Cancel request</button>
                </div>

                <form id="join-team-form" class="form">
                  <div class="form-grid">
                    <label class="field">
                      <span class="label">Choose a team</span>
                      <select id="join-teamSelect" class="input" required>
                        <option value="">Loading teams…</option>
                      </select>
                    </label>

                    <div class="two-col">
                      <label class="field">
                        <span class="label">Your name</span>
                        <input type="text" id="join-name" class="input" placeholder="Name" required>
                      </label>

                      <label class="field">
                        <span class="label">Your Discord</span>
                        <input type="text" id="join-discord" class="input" placeholder="@username" required>
                      </label>
                    </div>
                  </div>

                  <div class="form-actions">
                    <button type="submit" id="join-btn" class="btn primary">Send request</button>
                    <span class="hint" id="join-hint"></span>
                  </div>
                </form>
              </details>

              <details class="accordion" id="manage-accordion">
                <summary>
                  <span>Manage your team</span>
                  <span class="pill">owner</span>
                </summary>

                <div class="manage-note">
                  You created this team from this device. You can rename your team, accept or decline join requests, remove members, and delete your team.
                </div>

                <span class="hint" id="manage-hint"></span>
                <div id="manage-area" class="manage-area"></div>
              </details>
            </div>
          </div>
        </section>


        
        <!-- Panel 2b: Requests (Owner) -->
        <section class="panel panel-register owner-only" id="panel-requests" style="display:none;">
          <div class="panel-inner">
            <h2>Requests</h2>
            <p class="subtitle small">Review and approve join requests for your team.</p>
            <span class="hint" id="requests-hint"></span>
            <div id="requests-area" class="manage-area"></div>
          </div>
        </section>
<!-- Panel 3: Teams -->
        
        <section class="panel panel-teams" id="panel-teams">
          <div class="panel-inner">
            <h2>Teams <span id="team-count-header">0</span>/6</h2>
            <p class="subtitle small">Tap a team to expand members and see pending requests.</p>
            <span class="hint" id="roster-hint"></span>
            <div class="teams-list" id="teams-list">
              <!-- Filled by JS -->
            </div>
          </div>
        </section>

      </main>

      <!-- Mobile Tabs -->
      <nav class="mobile-tabs">
        <button class="tab active" data-panel="panel-home" id="tab-home-mobile">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/></svg>
          <span>Home</span>
        </button>
        <button class="tab" data-panel="panel-register" id="tab-register-mobile">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 5v14M5 12h14"/></svg>
          <span>Register</span>
        </button>
        <button class="tab owner-only" data-panel="panel-requests" id="tab-requests-mobile" style="display:none;">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M4 4h16v14H4z"/><path d="M8 2v4"/><path d="M16 2v4"/><path d="M4 10h16"/><path d="M8 14h4"/><path d="M8 18h8"/></svg>
          <span>Requests</span>
        </button>        <button class="tab" data-panel="panel-teams" id="tab-teams-mobile">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M23 21v-2a4 4 0 0 0-3-3.87M16 3.13a4 4 0 0 1 0 7.75"/></svg>
          <span>Teams</span>
        </button>
      </nav>

      <!-- First-load chooser -->
      <div class="mode-modal" id="mode-modal" style="display:none;" role="dialog" aria-modal="true">
        <div class="mode-card">
          <div class="mode-title">What do you want to do?</div>
          <div class="mode-sub">Pick one — you can switch anytime using the tabs.</div>
          <div class="mode-actions">
            <button class="btn primary" id="mode-create" type="button">Create / manage a team</button>
            <button class="btn" id="mode-join" type="button">Join a team</button>
          </div>
          <button class="mode-skip" id="mode-skip" type="button">Skip</button>
        </div>
      </div>
    </div>

    <script src="app.js"></script>
  </body>
</html>
